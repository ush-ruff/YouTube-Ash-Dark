/* ==UserStyle==
@name           Youtube Ash Dark
@namespace      github.com/ush-ruff
@homepageURL    https://github.com/ush-ruff/Youtube-Ash-Dark
@updateURL      https://github.com/ush-ruff/Youtube-Ash-Dark/raw/main/youtube.user.css
@version        1.1.1
@description    Fixes YouTube some layout elements in dark mode, restore and/or removes some annoying elements like the filter bar or new video description.
@author         ushruff
@preprocessor   stylus
@license        GNU GPLv3
@var            checkbox hideFilterBar "Hide Filter Bar" 1
@var            checkbox hideComments "Hide Comments" 0
@var            range endCardOpacity "End Card Opacity" [0.35, 0, 1, 0.05]
@var            checkbox restoreDesc "Restore Old Description Style" 1
==/UserStyle== */

@-moz-document domain("youtube.com") {
	:root, [dark] {
		scrollbar-color: #4c4c4c #2c2c2c !important;
		scrollbar-width: thin !important;
		--yt-spec-text-primary: #d2d2d2 !important;
		--paper-checkbox-unchecked-color: var(--yt-spec-text-primary) !important;
		--like: #23a923;
		--dislike: hsl(0, 60%, 45%);
	}

	::selection {
		background: #5c5c5c;
	}

	html {
		background: #2a2a2a;
	}

	/* ----- Icons ----- */
	yt-icon-button {
		--yt-button-color: var(--yt-spec-text-primary);
		--yt-spec-brand-icon-inactive: var(--yt-spec-text-primary);
	}

	#voice-search-button.ytd-masthead {
		background-color: transparent !important;
	}

	/* ----- Search ----- */
	.sbsb_a, .sbfl_b {
		background-color: #2c2c2c;
		cursor: pointer;
	}

	.sbdd_b {
		border: 1px solid #4c4c4c;
	}

	.sbsb_d {
		background-color: #4c4c4c;
	}

	.sbfl_a {
		color: #aaa;
	}

	.gsfs, .sbfl_a:hover {
		color: #ddd;
	}

	.sbpqs_a {
		color: #b388ff;
		font-weight: lighter;
	}
  
  .sbpqs_a::before,   
  .sbqs_c::before {
    filter: invert(0.7);
  }
  
  .sbpqs_c {
    color: #aaa;
  }

	.sbsb_i {
		color: #4285f4;
	}
  
	ytd-masthead[desktop-mic-background] #voice-search-button.ytd-masthead {
		background-color: transparent;
	}
  
  .focused-line.tp-yt-paper-input-container {
    border-bottom-color: #4285f4;
  }

	/* ----- Videos Play Button ----- */
	.ytp-cued-thumbnail-overlay .ytp-large-play-button {
		width: 100%;
		height: 100%;
		top: 0;
		left: 0;
		margin: 0;
	}

	.ytp-cued-thumbnail-overlay .ytp-large-play-button svg {
		position: absolute;
		width: 60px;
		height: 48px;
		top: 50%;
		left: 50%;
		margin: -24px 0 0 -34px;
	}

	/* ----- Recommended Filter Bar Hide ----- */
	if hideFilterBar == 1 {
		ytd-feed-filter-chip-bar-renderer, yt-related-chip-cloud-renderer {
			display: none;
		}
	}

	/* ----- End Card Channel Button ----- */
	.ytp-ce-expanding-overlay-background {
		background-color: #2a2a2a;
		color: #ddd;
	}

	.ytp-ce-channel-this .ytp-ce-channel-metadata, .yt-ui-ellipsis, .ytp-ce-channel-subscribers-text {
		border-color: #3c3c3c;
		background-color: transparent;
		color: inherit;
	}

	.ytp-ce-channel-title.ytp-ce-link, .ytp-ce-channel-title.ytp-ce-link:hover {
		color: #3ea6ff;
	}

	.ytp-sb-unsubscribe {
		background-color: #3c3c3c;
		color: #aaa;
	}

	/* ----- End Card Video Recommendations ----- */
	.ytp-ce-element.ytp-ce-element-show {
		opacity: endCardOpacity;
	}

	.ytp-ce-element.ytp-ce-element-show:is(:hover, :focus) {
		opacity: 1;
	}

	/* ----- End Card External Links ----- */
	.ytp-ce-website .ytp-ce-expanding-image, .ytp-ce-merchandise .ytp-ce-expanding-image {
		background-color: transparent;
	}

	.ytp-ce-website-title, .ytp-ce-merchandise-title {
		color: #ddd;
	}

	.ytp-ce-size-1920 .ytp-ce-expanding-icon {
		display: none;
	}

	.ytp-ce-website[aria-label^="Patreon"] .ytp-ce-expanding-image[style*="hsI7JwLnthU/3423407610981483187_mq.jpg?v=6004c2cb"],
	.ytp-ce-website[aria-label^="Patreon"] .ytp-ce-expanding-image[style*="j0ls-vNThOY/3423407610981483187_mq.jpg?v=600bb4c8"] {
		border-radius: 50%;
		border: 1px solid #ddd;
	}

	/* ----- Like Bar ----- */
	#container.ytd-sentiment-bar-renderer {
		/* background-color: #960909; */
		background-color: var(--dislike);
	}

	#like-bar.ytd-sentiment-bar-renderer {
		background: rgba(35, 169, 35, .8);
	}

	ytd-sentiment-bar-renderer[activated] #like-bar.ytd-sentiment-bar-renderer, 
	ytd-sentiment-bar-renderer[activated][system-icons] #like-bar.ytd-sentiment-bar-renderer {
		background: var(--like);
	}

	ytd-toggle-button-renderer:nth-of-type(1) #button.ytd-toggle-button-renderer.style-default-active {
		color: var(--like);
		+ #text {
				color: var(--like);
		}
	}

	ytd-toggle-button-renderer:nth-of-type(2) #button.ytd-toggle-button-renderer.style-default-active {
		color: var(--dislike);
		+ #text {
				color: var(--dislike);
		}
	}

	/* ----- Comment ----- */
	#input-container.ytd-commentbox {
		--paper-input-container-underline-focus_-_border-color: #4285f4;
		--paper-input-container-underline-focus-border-color: #4285f4;
	}
  
  /* ----- Comment Section - Hide ------ */
	if hideComments == 1 {
		#comments #contents {
			display: none;
		}
		
		#comments::after {
			content: "========== Comments Hidden by UserStyle ==========";
			display: block;
			font-size: 14px;
			text-align: center;
		}
	}

	/* ----- History ----- */
	.focused-line.paper-input-container {
		--paper-input-container-underline-focus_-_border-color: #4285f4;
		--paper-input-container-underline-focus-border-color: #4285f4;
	}

	/* ----- (i) Cards ----- */
	.iv-drawer {
		background-color: rgba(0, 0, 0, 0.60);
	}

	.iv-card {
		background-color: #181818;
	}

	.iv-card-image {
		border-color: #303030;
		background: #2a2a2a;
	}

	.iv-card-message {
		border-color: #303030;
		color: #ddd;
	}

	.iv-card h2, .iv-card-meta-info {
		color: #ccc;
	}

	.iv-card .iv-card-primary-link {
		color: #3ea6ff;
	}

	/* ----- Chapter Title - Fullscreen ----- */
	.ytp-big-mode .ytp-chrome-controls .ytp-chapter-title.ytp-button {
		width: 100%;
	}
  
  /* ---- Share Clip ---- */
  #target[title="Embed"] circle {
    fill: #888;
  }
  #target[title="Embed"] path {
    fill: var(--yt-spec-text-primary);
  }
  
  /* ---- Toast ---- */
  yt-notification-action-renderer[ui-refresh] tp-yt-paper-toast.yt-notification-action-renderer {
    background-color: #303030;
  }
  yt-notification-action-renderer[ui-refresh] #text.yt-notification-action-renderer, yt-notification-action-renderer[ui-refresh] #sub-text.yt-notification-action-renderer {
    color: var(--yt-spec-text-primary);
  }
}

@-moz-document domain("youtube.com") {
  /* ----- Restore Old Description Style ----- */
  if (restoreDesc == 1) {
    ytd-watch-metadata.ytd-watch-flexy {
      padding-bottom: 2em;
      border-bottom: 1px solid var(--yt-spec-10-percent-layer);
    }

    #above-the-fold {
      display: grid;
      grid-template-areas: "title title" "subtitle actions" "channel channel" "description description";
      grid-template-columns: max-content 1fr;

      #title {
        grid-area: title;
        align-self: end;
      }
      
      #owner-and-teaser {
        grid-area: channel;
      }

      #owner {
        position: relative;
        margin-block: 1em;
        border: none;

        &::before {
          content: "";
          position: absolute;
          width: 100%;
          height: 1px;
          top: -0.5em;
          left: 0;
          background: var(--yt-spec-10-percent-layer);
        }
      }

      #comment-teaser {
        display: none;
      }

      #description-and-actions {
        position: relative;
        display: grid;
        grid-template-rows: subgrid;
        grid-template-columns: subgrid;
        grid-row: 2 / -1;
        grid-column: 1 / -1;
      }

      #actions {
        grid-area: actions;
      }

      #description {
        grid-area: description;
        margin-inline-start: 5em;
      }

      /* Views & Date */
      #description-inline-expander {
        position: static;
        overflow: visible;
        contain: unset;
      }

      #snippet {
        overflow: visible !important;
        mask-image: none !important;
      }

      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(1), 
      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(3) {
        position: absolute;
        top: 1.2em;
        font-weight: 400;
        color: var(--yt-spec-text-secondary);
      }
      
      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(1) {
        left: 0;
      }

      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(3) {
        display: flex;
        left: 9em;
      }
      
      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(3)::before {
        content: "Â·";
        align-self: center;
        font-size: 2.3em;
        margin-right: 1rem;
      }

      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(2), 
      #description-inline-expander .ytd-text-inline-expander span.yt-formatted-string:nth-child(4) {
        display: none;
      }

      /* Show more/less */
      #expand {
        position: relative;
        left: 0 !important;
        margin-top: 0.5em;
        padding: 0;
        color: transparent;

        &::before {
          content: "show more";
          text-transform: uppercase;
          color: var(--yt-spec-text-primary); 
        }
      }

      #collapse {
        text-transform: uppercase;
        margin-top: 0.5em;
        padding: 0;
      }
    }
    
    /* Category Tags */
    #above-the-fold + ytd-metadata-row-container-renderer {
      margin-block-start: 2em;
      margin-inline-start: 6em;
    }
  }
}