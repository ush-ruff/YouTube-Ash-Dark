/* ==UserStyle==
@name           Youtube Ash Dark
@namespace      github.com/ush-ruff
@homepageURL    https://github.com/ush-ruff/Youtube-Ash-Dark
@updateURL      https://github.com/ush-ruff/Youtube-Ash-Dark/raw/main/youtube.user.css
@version        1.4.3
@description    Fixes YouTube some layout elements in dark mode, restore and/or removes some annoying elements like the filter bar or new video description.
@author         ushruff
@preprocessor   stylus
@license        GNU GPLv3
@var            checkbox customGrid "Enable Custom Grid on Homepage" 0
@var            number customGridColumns "Number of Grid Columns" [5, 4, 10, 1]
@var            checkbox disablePreview "Disable Thumbnail Previews (Autoplay)" 0
@var            checkbox hideFilterBar "Hide - Filter Bar" 1
@var            checkbox hidePlayerControls "Hide Player Overlays in Fullscreen" 0
@var            range endCardOpacity "Video End Card Opacity" [0.35, 0, 1, 0.05]
@var            checkbox restoreDesc "Restore Old Description Style" 1
@var            checkbox hideComments "Hide - Comments" 0
@var            checkbox restoreCommentReplies "Restore Old Comment Replies Style" 0
==/UserStyle== */

@-moz-document domain("youtube.com") {
/*
  *	===================================================
  *    ╔╦╗╔═╗╦═╗╦╔═  ╔╦╗╦ ╦╔═╗╔╦╗╔═╗  ╔═╗╦═╗ ╦╔═╗╔═╗
  *     ║║╠═╣╠╦╝╠╩╗   ║ ╠═╣║╣ ║║║║╣   ╠╣ ║╔╩╦╝║╣ ╚═╗
  *    ═╩╝╩ ╩╩╚═╩ ╩   ╩ ╩ ╩╚═╝╩ ╩╚═╝  ╚  ╩╩ ╚═╚═╝╚═╝
  *	===================================================
*/

  :root, [dark] {
    scrollbar-color: #4c4c4c #2c2c2c !important;
    scrollbar-width: thin !important;
    --yt-spec-text-primary: #d2d2d2 !important;
    --paper-checkbox-unchecked-color: var(--yt-spec-text-primary) !important;
    --like: #23a923;
    --dislike: hsl(0, 60%, 45%);
  }

  ::selection {
    background: #5c5c5c;
  }

  html {
    background: #2a2a2a;
  }

  /* ----- Icons ----- */
  yt-icon-button {
    --yt-button-color: var(--yt-spec-text-primary);
    --yt-spec-brand-icon-inactive: var(--yt-spec-text-primary);
  }

  #voice-search-button.ytd-masthead {
    background-color: transparent !important;
  }

  /* ----- Search ----- */
  .sbsb_a, .sbfl_b {
    background-color: #2c2c2c;
    cursor: pointer;
  }

  .sbdd_b {
    border: 1px solid #4c4c4c;
  }

  .sbsb_d {
    background-color: #4c4c4c;
  }

  .sbfl_a {
    color: #aaa;
  }

  .gsfs, .sbfl_a:hover {
    color: #ddd;
  }

  .sbpqs_a {
    color: #b388ff;
    font-weight: lighter;
  }
  
  .sbpqs_a::before,   
  .sbqs_c::before {
    filter: invert(0.7);
  }
  
  .sbpqs_c {
    color: #aaa;
  }

  .sbsb_i {
    color: #4285f4;
  }
  
  ytd-masthead[desktop-mic-background] #voice-search-button.ytd-masthead {
    background-color: transparent;
  }
  
  .focused-line.tp-yt-paper-input-container {
    border-bottom-color: #4285f4;
  }

  /* ----- Video End Card - Channel Button ----- */
  .ytp-ce-expanding-overlay-background {
    background-color: #2a2a2a;
    color: #ddd;
  }

  .ytp-ce-channel-this .ytp-ce-channel-metadata, .yt-ui-ellipsis, .ytp-ce-channel-subscribers-text {
    border-color: #3c3c3c;
    background-color: transparent;
    color: inherit;
  }

  .ytp-ce-channel-title.ytp-ce-link, .ytp-ce-channel-title.ytp-ce-link:hover {
    color: #3ea6ff;
  }

  .ytp-sb-unsubscribe {
    background-color: #3c3c3c;
    color: #aaa;
  }

  /* ----- Video End Card - Video Recommendations ----- */
  .ytp-ce-element.ytp-ce-element-show {
    opacity: endCardOpacity;
  }

  .ytp-ce-element.ytp-ce-element-show:is(:hover, :focus) {
    opacity: 1;
  }

  /* ----- Video End Card - External Links ----- */
  .ytp-ce-website .ytp-ce-expanding-image, .ytp-ce-merchandise .ytp-ce-expanding-image {
    background-color: transparent;
  }

  .ytp-ce-website-title, .ytp-ce-merchandise-title {
    color: #ddd;
  }

  .ytp-ce-size-1920 .ytp-ce-expanding-icon {
    display: none;
  }

  .ytp-ce-website[aria-label^="Patreon"] .ytp-ce-expanding-image[style*="hsI7JwLnthU/3423407610981483187_mq.jpg?v=6004c2cb"],
  .ytp-ce-website[aria-label^="Patreon"] .ytp-ce-expanding-image[style*="j0ls-vNThOY/3423407610981483187_mq.jpg?v=600bb4c8"] {
    border-radius: 50%;
    border: 1px solid #ddd;
  }

  /* ----- Info Cards (i) ----- */
  .iv-drawer {
    background-color: rgba(0, 0, 0, 0.60);
  }

  .iv-card {
    background-color: #181818;
  }

  .iv-card-image {
    border-color: #303030;
    background: #2a2a2a;
  }

  .iv-card-message {
    border-color: #303030;
    color: #ddd;
  }

  .iv-card h2, .iv-card-meta-info {
    color: #ccc;
  }

  .iv-card .iv-card-primary-link {
    color: #3ea6ff;
  }

  /* ----- Like Bar ----- */
  #container.ytd-sentiment-bar-renderer {
    /* background-color: #960909; */
    background-color: var(--dislike);
  }

  #like-bar.ytd-sentiment-bar-renderer {
    background: rgba(35, 169, 35, .8);
  }

  ytd-sentiment-bar-renderer[activated] #like-bar.ytd-sentiment-bar-renderer, 
  ytd-sentiment-bar-renderer[activated][system-icons] #like-bar.ytd-sentiment-bar-renderer {
    background: var(--like);
  }

  ytd-toggle-button-renderer:nth-of-type(1) #button.ytd-toggle-button-renderer.style-default-active {
    color: var(--like);
    + #text {
        color: var(--like);
    }
  }

  ytd-toggle-button-renderer:nth-of-type(2) #button.ytd-toggle-button-renderer.style-default-active {
    color: var(--dislike);
    + #text {
        color: var(--dislike);
    }
  }

  /* ----- Comment - Composer Input ----- */
  #input-container.ytd-commentbox {
    --paper-input-container-underline-focus_-_border-color: #4285f4;
    --paper-input-container-underline-focus-border-color: #4285f4;
  }

  /* ----- History - Search Input ----- */
  .focused-line.paper-input-container {
    --paper-input-container-underline-focus_-_border-color: #4285f4;
    --paper-input-container-underline-focus-border-color: #4285f4;
  }

  /* ---- Share Clip - Embed Icon ---- */
  #target[title="Embed"] circle {
    fill: #f00;
    stroke-width: 0;
  }

  #target[title="Embed"] path {
    fill: #fff;
    stroke: #fff;
    stroke-width: 0.5;
  }
  
  /* ---- Toast Notifications ---- */
  yt-notification-action-renderer[ui-refresh] tp-yt-paper-toast.yt-notification-action-renderer {
    background-color: #303030;
  }

  yt-notification-action-renderer[ui-refresh] #text.yt-notification-action-renderer, yt-notification-action-renderer[ui-refresh] #sub-text.yt-notification-action-renderer {
    color: var(--yt-spec-text-primary);
  }


/*
  *	=====================================
  *    ╔═╗╔╦╗╦ ╦╔═╗╦═╗  ╔═╗╦═╗ ╦╔═╗╔═╗
  *    ║ ║ ║ ╠═╣║╣ ╠╦╝  ╠╣ ║╔╩╦╝║╣ ╚═╗
  *    ╚═╝ ╩ ╩ ╩╚═╝╩╚═  ╚  ╩╩ ╚═╚═╝╚═╝
  *	=====================================
*/
  /* ----- Custom Homepage Item Grid ----- */
  if (customGrid == 1) {
    @media (min-width:1400px) {
      #primary > ytd-rich-grid-renderer {
        --grid-margin: 7em;
        margin-inline: var(--grid-margin);
      }
      /* Fix filterbar width */
      ytd-feed-filter-chip-bar-renderer {
        margin-inline: calc(var(--grid-margin) * -1);
      }
      #chips-wrapper.ytd-feed-filter-chip-bar-renderer {
        width: calc(var(--ytd-rich-grid-chips-bar-width) + (var(--grid-margin) * 2));
      }
    }
    
    div#contents.style-scope.ytd-rich-grid-renderer {
      --custom-grid-columns-number: customGridColumns;
      --size: calc((100% - (var(--ytd-rich-grid-item-margin) * (var(--custom-grid-columns-number) + 1))) / var(--custom-grid-columns-number));
      display: block !important;
      margin-inline-start: calc(var(--ytd-rich-grid-item-margin) / 2);
    }

    @media (max-width:1400px) {
      div#contents.style-scope.ytd-rich-grid-renderer  {
        margin-inline-start: var(--ytd-rich-grid-item-margin);
      }
    }

    ytd-rich-grid-row.style-scope.ytd-rich-grid-renderer {
      display: inline !important;
    }

    ytd-rich-grid-row.style-scope.ytd-rich-grid-renderer > div {
      display: inline !important;
      margin: 0 !important;
    }

    ytd-rich-item-renderer:not([is-post], [is-slim-media]) {
      display: inline-block !important;
      width: var(--size) !important;
      contain: none !important;
    }

    ytd-rich-section-renderer[align-within-rich-grid] #content.ytd-rich-section-renderer {
      max-width: unset;
      margin: 0;
    }
    
    ytd-rich-section-renderer[align-within-rich-grid] #content.ytd-rich-section-renderer ytd-rich-item-renderer {
      margin-inline: var(--ytd-rich-grid-item-margin) 0;
    }
  }

  /* ----- Disable Thumbnail Preview (Autoplay) ----- */
  if (disablePreview == 1) {
    ytd-thumbnail-overlay-time-status-renderer {
      display: inline-flex !important;
    }

    ytd-video-preview, div#hover-overlays {
      display: none !important;
    }
  }

  /* ----- Recommended Filter Bar Hide ----- */
  if (hideFilterBar == 1) {
    ytd-feed-filter-chip-bar-renderer, yt-related-chip-cloud-renderer {
      display: none;
    }
  }

  /* ----- Hide Player Overlays in Fullscreen ----- */
  if (hidePlayerControls == 1) {
    /* -- Title -- */
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-gradient-top:not(:hover),
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top:not(:hover) {
      opacity: 0;
    }
    
    /* -- Controls -- */
    .ytp-fullscreen:not(.ended-mode) .ytp-gradient-bottom:not(:hover),
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom:not(:hover) {
      opacity: 0;
    }
    
    /* -- Background gradient -- */
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top::before, 
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom::before {
      content: "";
      position: absolute;
      height: 70px;
      background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAEmCAYAAACjy/qzAAAAhklEQVQ4y52RUQ6AMAxCKd7/JJ7R6aeJAdr507TjQZqOAE4CWARwx7JE944rch/k6qOWS7bq5bh72zGF8+LTa6goJeRPgXDYNxWFfkS0QXCInLIN1GxTXA0dtS0otWJnuXJR1Y9WYP9GF1UCYRQYHRSlXMARbVO4th3sd7Y3OP5dY3Bn+SkPsGJ1+HGGVtcAAAAASUVORK5CYII=");
      background-repeat: repeat-x;
      opacity: 0;
      transition: opacity .25s cubic-bezier(0,0,0.2,1);
      pointer-events: none;
      z-index: -1;
    }
    
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top::before {
      inset: 0 -10em auto;
      padding-bottom: 76px;
      background-position: top;
    }
    
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom::before {
      inset: auto -10em 0;
      padding-top: 76px;
      background-position: bottom;
    }
    
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top:hover::before,
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom:hover::before {
      opacity: 1;
    }
    
    
    /* -- Captions - Positon fix -- */
    .ytp-fullscreen:not(.ytp-autohide):not(.ended-mode) .ytp-caption-window-container {
      margin-top: 60px;
    }
  }

  /* ----- Restore Old Description Style ----- */
  if (restoreDesc == 1) {
    #primary-inner > ytd-watch-metadata {
      display: none !important;
    }

    #info-contents, #meta-contents {
      display: block !important;
    }

    #info-contents #container .title {
      font-family: "Roboto",sans-serif;
      font-weight: 400;
      font-size: 18px;
    }

    #more .more-button {
      color: transparent;

      &::before {
        content: "show more";
        text-transform: uppercase;
        color: var(--yt-spec-text-secondary);
      }
    }
  }

  /* ----- Comment Section - Hide ------ */
  if (hideComments == 1) {
    #comments #contents {
      display: none;
    }
    
    #comments::after {
      content: "========== Comments Hidden by UserStyle ==========";
      display: block;
      font-size: 14px;
      text-align: center;
    }
  }
}

  /* ----- Restore Old Comment Replies Style ----- */
  if (restoreCommentReplies == 1) {
    #more-replies #button:not([aria-label^="View" i]) #text,
    #less-replies #button:not([aria-label^="Hide" i]) #text {
      font-size: 14px;
      text-transform: lowercase;
    }

    #more-replies #button:not([aria-label^="View" i]) #text::before {
      content: "View ";
      text-transform: capitalize;
    }

    #less-replies #button:not([aria-label^="Hide" i]) #text::before {
      content: "Hide ";
      text-transform: capitalize;
    }

    #more-replies #button[aria-label="1 reply" i] #text,
    #less-replies #button[aria-label="1 reply" i] #text {
      color: transparent;

      &::before {
        color: var(--yt-spec-call-to-action);
        text-transform: initial;
      }
    }

    #more-replies #button[aria-label="1 reply" i] #text::before {
      content: "View reply";
    }

    #less-replies #button[aria-label="1 reply" i] #text::before {
      content: "Hide reply";
    }

    #more-replies-icon yt-icon, #less-replies-icon yt-icon {
      color: var(--yt-spec-call-to-action);
    }
  }
