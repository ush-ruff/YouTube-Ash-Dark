/* ==UserStyle==
@name           Youtube Ash Dark
@namespace      github.com/ush-ruff
@homepageURL    https://github.com/ush-ruff/Youtube-Ash-Dark
@updateURL      https://github.com/ush-ruff/Youtube-Ash-Dark/raw/main/youtube.user.css
@version        1.7.1
@description    Fixes YouTube some layout elements in dark mode, restore and/or removes some annoying elements like the filter bar or new video description.
@author         ushruff
@preprocessor   stylus
@license        GNU GPLv3
@var            checkbox customGrid "Enable Custom Grid on Homepage" 0
@var            number customGridColumns "Number of Grid Columns" [5, 4, 10, 1]
@var            checkbox disablePreview "Disable Thumbnail Previews (Autoplay)" 0
@var            checkbox customThumbnailMeta "Enable Custom Thumbnail Details" 0
@var            checkbox hideFilterBar "Hide Filter Bar" 1
@var            checkbox hidePlayerControls "Hide Player Overlays in Fullscreen" 0
@var            range endCardOpacity "Video End Card Opacity" [0.35, 0, 1, 0.05]
@var            checkbox restoreDesc "Restore Old Description Style" 1
@var            checkbox hideComments "Hide Comments" 0
@var            checkbox restoreCommentReplies "Restore Old Comment Replies Style" 0
@var            checkbox restoreButtonStyle "Restore Button Styles" 1
@var            checkbox restoreIconStyle "Restore Solid Icons to Description and Comments" 0
==/UserStyle== */

@-moz-document domain("youtube.com") {
/*
  *	===================================================
  *    ╔╦╗╔═╗╦═╗╦╔═  ╔╦╗╦ ╦╔═╗╔╦╗╔═╗  ╔═╗╦═╗ ╦╔═╗╔═╗
  *     ║║╠═╣╠╦╝╠╩╗   ║ ╠═╣║╣ ║║║║╣   ╠╣ ║╔╩╦╝║╣ ╚═╗
  *    ═╩╝╩ ╩╩╚═╩ ╩   ╩ ╩ ╩╚═╝╩ ╩╚═╝  ╚  ╩╩ ╚═╚═╝╚═╝
  *	===================================================
*/

  :root, [dark] {
    scrollbar-color: #4c4c4c #2c2c2c !important;
    scrollbar-width: thin !important;
    --yt-spec-text-primary: #d2d2d2 !important;
    --paper-checkbox-unchecked-color: var(--yt-spec-text-primary) !important;
    --like: #23a923;
    --dislike: hsl(0, 60%, 45%);
    --accent-blue: #3ea6ff;
    --accent-blue-dark: #4285f4;
  }

  ::selection {
    background: #5c5c5c;
  }

  html {
    background: #2a2a2a;
  }

  /* ----- Icons ----- */
  yt-icon-button {
    --yt-button-color: var(--yt-spec-text-primary);
    --yt-spec-brand-icon-inactive: var(--yt-spec-text-primary);
  }

  #voice-search-button.ytd-masthead {
    background-color: transparent !important;
  }

  /* ----- Search ----- */
  .sbsb_a, .sbfl_b {
    background-color: #2c2c2c;
    cursor: pointer;
  }

  .sbdd_b {
    border: 1px solid #4c4c4c;
  }

  .sbsb_d {
    background-color: #4c4c4c;
  }

  .sbfl_a {
    color: #aaa;
  }

  .gsfs, .sbfl_a:hover {
    color: #ddd;
  }

  .sbpqs_a {
    color: #b388ff;
    font-weight: lighter;
  }
  
  .sbpqs_a::before, .sbqs_c::before {
    filter: invert(0.7);
  }
  
  .sbpqs_c {
    color: #aaa;
  }

  .sbsb_i {
    color: var(--accent-blue-dark);
  }
  
  ytd-masthead[desktop-mic-background] #voice-search-button.ytd-masthead {
    background-color: transparent;
  }
  
  .focused-line.tp-yt-paper-input-container {
    border-bottom-color: var(--accent-blue-dark);
  }

  /* ----- Video End Card - Channel Button ----- */
  .ytp-ce-expanding-overlay-background {
    background-color: #2a2a2a;
    color: #ddd;
  }

  .ytp-ce-channel-this .ytp-ce-channel-metadata, .yt-ui-ellipsis, .ytp-ce-channel-subscribers-text {
    border-color: #3c3c3c;
    background-color: transparent;
    color: inherit;
  }

  .ytp-ce-channel-title.ytp-ce-link, .ytp-ce-channel-title.ytp-ce-link:hover {
    color: var(--accent-blue);
  }

  .ytp-sb-unsubscribe {
    background-color: #3c3c3c;
    color: #aaa;
  }

  /* ----- Video End Card - Video Recommendations ----- */
  .ytp-ce-element.ytp-ce-element-show {
    opacity: endCardOpacity;
  }

  .ytp-ce-element.ytp-ce-element-show:is(:hover, :focus) {
    opacity: 1;
  }

  /* ----- Video End Card - External Links ----- */
  .ytp-ce-website .ytp-ce-expanding-image, .ytp-ce-merchandise .ytp-ce-expanding-image {
    background-color: transparent;
  }

  .ytp-ce-website-title, .ytp-ce-merchandise-title {
    color: #ddd;
  }

  .ytp-ce-size-1920 .ytp-ce-expanding-icon {
    display: none;
  }

  /* ----- Info Cards (i) ----- */
  .iv-drawer {
    background-color: rgba(0, 0, 0, 0.60);
  }

  .iv-card {
    background-color: #181818;
  }

  .iv-card-image {
    border-color: #303030;
    background: #2a2a2a;
  }

  .iv-card-message {
    border-color: #303030;
    color: #ddd;
  }

  .iv-card h2, .iv-card-meta-info {
    color: #ccc;
  }

  .iv-card .iv-card-primary-link {
    color: var(--accent-blue);
  }

  /* ----- Like Bar ----- */
  #container.ytd-sentiment-bar-renderer {
    /* background-color: #960909; */
    background-color: var(--dislike);
  }

  #like-bar.ytd-sentiment-bar-renderer {
    background: rgba(35, 169, 35, .8);
  }

  ytd-sentiment-bar-renderer:is([activated] ,[activated][system-icons]) #like-bar.ytd-sentiment-bar-renderer {
    background: var(--like);
  }

  ytd-toggle-button-renderer:nth-of-type(1) #button.ytd-toggle-button-renderer.style-default-active {
    color: var(--like);
    + #text {
      color: var(--like);
    }
  }

  ytd-toggle-button-renderer:nth-of-type(2) #button.ytd-toggle-button-renderer.style-default-active {
    color: var(--dislike);
    + #text {
      color: var(--dislike);
    }
  }

  :is(#segmented-like-button, #like-button) .yt-spec-button-shape-next[aria-pressed="true" i] {
    color: var(--like);
  }
  
  :is(#segmented-dislike-button, #dislike-button) .yt-spec-button-shape-next[aria-pressed="true" i] {
    color: var(--dislike);
  }

  /* ----- Comment - Composer Input ----- */
  #input-container.ytd-commentbox {
    --paper-input-container-underline-focus_-_border-color: var(--accent-blue-dark);
    --paper-input-container-underline-focus-border-color: var(--accent-blue-dark);
  }

  /* ----- Comment - Replies Expander ----- */
  #replies #expander .dot {
    color: var(--yt-spec-call-to-action);
  }

  /* ----- History - Search Input ----- */
  .focused-line.paper-input-container {
    --paper-input-container-underline-focus_-_border-color: var(--accent-blue-dark);
    --paper-input-container-underline-focus-border-color: var(--accent-blue-dark);
  }

  /* ---- Share Clip - Embed Icon ---- */
  #target[title="Embed"] circle {
    fill: #f00;
    stroke-width: 0;
  }

  #target[title="Embed"] path {
    fill: #fff;
    stroke: #fff;
    stroke-width: 0.5;
  }
  
  /* ---- Toast Notifications ---- */
  #toast {
    background-color: #303030;
    border-radius: 3px;
    
    #text, #sub-text {
      color: var(--yt-spec-text-primary);
    }
    
    yt-button-renderer a {
      color: var(--accent-blue);
    }
  }

}

@-moz-document domain("youtube.com") {
/*
  *	=====================================
  *    ╔═╗╔╦╗╦ ╦╔═╗╦═╗  ╔═╗╦═╗ ╦╔═╗╔═╗
  *    ║ ║ ║ ╠═╣║╣ ╠╦╝  ╠╣ ║╔╩╦╝║╣ ╚═╗
  *    ╚═╝ ╩ ╩ ╩╚═╝╩╚═  ╚  ╩╩ ╚═╚═╝╚═╝
  *	=====================================
*/

  /* ----- Custom Homepage Item Grid ----- */
  if (customGrid == 1) {
    @media (min-width:1400px) {
      #primary > ytd-rich-grid-renderer {
        --grid-margin: 7em;
        margin-inline: var(--grid-margin);
      }
      /* Fix filterbar width */
      ytd-feed-filter-chip-bar-renderer {
        margin-inline: calc(var(--grid-margin) * -1);
      }
      #chips-wrapper.ytd-feed-filter-chip-bar-renderer {
        width: calc(var(--ytd-rich-grid-chips-bar-width) + (var(--grid-margin) * 2));
      }
    }
    
    div#contents.style-scope.ytd-rich-grid-renderer {
      --custom-grid-columns-number: customGridColumns;
      --size: calc((100% - (var(--ytd-rich-grid-item-margin) * (var(--custom-grid-columns-number) + 1))) / var(--custom-grid-columns-number));
      display: block !important;
      margin-inline-start: calc(var(--ytd-rich-grid-item-margin) / 2);
    }

    @media (max-width:1400px) {
      div#contents.style-scope.ytd-rich-grid-renderer  {
        margin-inline-start: var(--ytd-rich-grid-item-margin);
      }
    }

    ytd-rich-grid-row.style-scope.ytd-rich-grid-renderer {
      display: inline !important;
    }

    ytd-rich-grid-row.style-scope.ytd-rich-grid-renderer > div {
      display: inline !important;
      margin: 0 !important;
    }

    ytd-rich-item-renderer:not([is-post], [is-slim-media]) {
      display: inline-block !important;
      width: var(--size) !important;
      contain: none !important;
    }

    ytd-rich-section-renderer[align-within-rich-grid] #content.ytd-rich-section-renderer {
      max-width: unset;
      margin: 0;
    }
    
    ytd-rich-section-renderer[align-within-rich-grid] #content.ytd-rich-section-renderer ytd-rich-item-renderer {
      margin-inline: var(--ytd-rich-grid-item-margin) 0;
    }
  }

  /* ----- Disable Thumbnail Preview (Autoplay) ----- */
  if (disablePreview == 1) {
    ytd-thumbnail-overlay-time-status-renderer {
      display: inline-flex !important;
    }

    ytd-video-preview, div#hover-overlays {
      display: none !important;
    }
  }

  /* ----- Custom Thumbnail Details ----- */
  if (customThumbnailMeta == 1) {
    @supports (grid-template-rows: subgrid) {
      #details.ytd-rich-grid-media {
        display: grid;
        grid-template-areas: "title title menu" "logo meta meta" "empty badges badges";
        grid-template-columns: 36px 1fr 24px;
        gap: 0.5rem 0;
        margin-block-end: -1.5rem;

        #avatar-link {
          grid-area: logo;
          margin: 0;
        }

        #meta {
          grid-row: 1 / -1;
          grid-column: 1 / -1;
          display: grid;
          grid-template-rows: subgrid;
          grid-template-columns: subgrid;
          padding: 0;

          h3 {
            grid-area: title;
          }

          .badge-style-type-collection.ytd-badge-supported-renderer {
            padding: 0 0 0.2rem;
          }

          ytd-video-meta-block {
            grid-area: meta;
            margin-inline-start: 1rem;
          }

          .video-badge {
            grid-area: badges;
            margin-inline-start: 1rem;
          }

          #buttons {
            grid-area: badges;
          }
        }

        #menu ytd-menu-renderer {
          top: 6px;
          right: -6px;
        }
      }
    } 
  }

  /* ----- Recommended Filter Bar Hide ----- */
  if (hideFilterBar == 1) {
    ytd-feed-filter-chip-bar-renderer, yt-related-chip-cloud-renderer {
      display: none;
    }
  }

  /* ----- Hide Player Overlays in Fullscreen ----- */
  if (hidePlayerControls == 1) {
    /* -- Title -- */
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-gradient-top:not(:hover),
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top:not(:hover) {
      opacity: 0;
    }
    
    /* -- Controls -- */
    .ytp-fullscreen:not(.ended-mode) .ytp-gradient-bottom:not(:hover),
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom:not(:hover) {
      opacity: 0;
    }
    
    /* -- Background gradient -- */
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top::before, 
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom::before {
      content: "";
      position: absolute;
      height: 70px;
      background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAEmCAYAAACjy/qzAAAAhklEQVQ4y52RUQ6AMAxCKd7/JJ7R6aeJAdr507TjQZqOAE4CWARwx7JE944rch/k6qOWS7bq5bh72zGF8+LTa6goJeRPgXDYNxWFfkS0QXCInLIN1GxTXA0dtS0otWJnuXJR1Y9WYP9GF1UCYRQYHRSlXMARbVO4th3sd7Y3OP5dY3Bn+SkPsGJ1+HGGVtcAAAAASUVORK5CYII=");
      background-repeat: repeat-x;
      opacity: 0;
      transition: opacity .25s cubic-bezier(0,0,0.2,1);
      pointer-events: none;
      z-index: -1;
    }
    
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top::before {
      inset: 0 -10em auto;
      padding-bottom: 76px;
      background-position: top;
    }
    
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom::before {
      inset: auto -10em 0;
      padding-top: 76px;
      background-position: bottom;
    }
    
    .ytp-fullscreen:not(.paused-mode):not(.ended-mode) .ytp-chrome-top:hover::before,
    .ytp-fullscreen:not(.ended-mode) .ytp-chrome-bottom:hover::before {
      opacity: 1;
    }
    
    
    /* -- Captions - Positon fix -- */
    .ytp-fullscreen:not(.ytp-autohide):not(.ended-mode) .ytp-caption-window-container {
      margin-top: 60px;
    }
  }

  /* ----- Restore Old Description Style ----- */
  if (restoreDesc == 1) {
    #primary-inner ytd-watch-metadata {
      display: none !important;
    }

    #info-contents, #meta-contents {
      display: block !important;
    }

    #info-contents #container .title {
      font-family: "Roboto",sans-serif;
      font-weight: 400;
      font-size: 18px;
    }

    #meta-contents {
      --ytd-channel-name-text-font-size: 14px;
    }

    #more .more-button {
      color: transparent;

      &::before {
        content: "show more";
        text-transform: uppercase;
        color: var(--yt-spec-text-secondary);
      }
    }

    #segmented-like-button .yt-spec-button-shape-next::after {
      all: unset;
    }
    
    #segmented-dislike-button .yt-spec-button-shape-next {
      width: auto;
    }
      
    #segmented-dislike-button .yt-spec-button-shape-next:after {
      content: "DISLIKE";
      font-size: 14px;
      font-weight: 500;
      text-transform: uppercase;
    }
  }

  /* ----- Comment Section - Hide ------ */
  if (hideComments == 1) {
    #comments #contents {
      display: none;
    }
    
    #comments::after {
      content: "========== Comments Hidden by UserStyle ==========";
      display: block;
      font-size: 14px;
      text-align: center;
    }
  }

  /* ----- Restore Old Comment Replies Style ----- */
  if (restoreCommentReplies == 1) {
    #more-replies #button:not([aria-label^="View" i]) #text,
    #less-replies #button:not([aria-label^="Hide" i]) #text,
    :is(#more-replies, #less-replies) button.yt-spec-button-shape-next .yt-spec-button-shape-next--button-text-content {
      font-size: 14px;
      text-transform: lowercase;
    }

    #more-replies #button:not([aria-label^="View" i]) #text::before, 
    #more-replies button.yt-spec-button-shape-next .yt-spec-button-shape-next--button-text-content::before {
      content: "View ";
      text-transform: capitalize;
    }

    #less-replies #button:not([aria-label^="Hide" i]) #text::before, 
    #less-replies button.yt-spec-button-shape-next .yt-spec-button-shape-next--button-text-content::before{
      content: "Hide ";
      text-transform: capitalize;
    }

    #more-replies #button[aria-label="1 reply" i] #text,
    #less-replies #button[aria-label="1 reply" i] #text {
      color: transparent;

      &::before {
        color: var(--yt-spec-call-to-action);
        text-transform: initial;
      }
    }

    #more-replies #button[aria-label="1 reply" i] #text::before {
      content: "View reply";
    }

    #less-replies #button[aria-label="1 reply" i] #text::before {
      content: "Hide reply";
    }

    #more-replies-icon yt-icon, #less-replies-icon yt-icon {
      color: var(--yt-spec-call-to-action);
    }

    #reply-button-end .yt-spec-button-shape-next .yt-spec-button-shape-next--button-text-content {
      text-transform: uppercase;
      color: var(--yt-spec-text-secondary);
      
      &:hover, &:focus {
        color: var(--yt-spec-text-primary);
      }
    }
  }

  /* ---- Restore Buttons Style ---- */
  if (restoreButtonStyle == 1) {
    .yt-spec-button-shape-next {
      border-radius: 0;
      
      .yt-spec-button-shape-next--button-text-content {
        text-transform: uppercase;
      }
      
      yt-touch-feedback-shape {
        display: none
      }
    }
    
    :is(#menu, #replies, #action-button, #action-buttons) .yt-spec-button-shape-next {
      background-color: transparent !important;
    }

    /* Subscribe Button */
    #subscribe-button .yt-spec-button-shape-next {
      border-radius: var(--yt-button-border-radius, 2px);
      
      &.yt-spec-button-shape-next--filled {
        background-color: var(--yt-spec-brand-button-background);
        color: var(--yt-spec-static-brand-white);
      }
    }
  }

  /* ---- Restore Solid Icons - Description and Comments ---- */
  if (restoreIconStyle == 1) {
    :root {
      --like-dislike: url(https://i.imgur.com/xkS6pxw.png);
      --other-icons: url(https://i.imgur.com/to2GF5T.png);
    }
    #segmented-like-button .yt-spec-button-shape-next, ytd-toggle-button-renderer:nth-of-type(1) button#button,
    #segmented-dislike-button .yt-spec-button-shape-next, ytd-toggle-button-renderer:nth-of-type(2) button#button,
    #like-button .yt-spec-button-shape-next, #dislike-button .yt-spec-button-shape-next,
    #top-level-buttons-computed .yt-spec-button-shape-next[aria-label="Share" i], ytd-button-renderer button#button[aria-label="Share" i],
    #flexible-item-buttons .yt-spec-button-shape-next[aria-label="Clip" i], ytd-button-renderer button#button[aria-label="Clip" i],
    #flexible-item-buttons .yt-spec-button-shape-next[aria-label="Save to playlist" i], ytd-button-renderer button#button[aria-label="Save to playlist" i]  {
      &::before {
        content: "";
        --size: 21px;
        width: var(--size);
        height: var(--size);
        margin-inline-end: 0.7rem;
        background-image: var(--like-dislike);
        background-size: calc(var(--size) * 2);
        background-repeat: no-repeat;
      }
      
      .yt-spec-button-shape-next__icon, yt-icon {
        display: none;
      }
    }
    
    /* Old YouTube layout style */
    ytd-toggle-button-renderer:nth-of-type(1) button#button, /* like */
    ytd-toggle-button-renderer:nth-of-type(2) button#button, /* dislike */
    ytd-button-renderer button#button[aria-label="Share" i], 
    ytd-button-renderer button#button[aria-label="Clip" i], 
    ytd-button-renderer button#button[aria-label="Save to playlist" i] {
      &::before {
        display: block;
      }
    }
    
    /* Comments - Like and Dislike */
    #like-button .yt-spec-button-shape-next, #like-button button#button, 
    #dislike-button .yt-spec-button-shape-next, #dislike-button button#button {
      &::before {
        --size: 16px;
        margin-inline-end: unset;
      }
      &:not([aria-pressed="true"])::before {
        filter: brightness(0.8);
      }
    }
    
    /* Like Button */
    #segmented-like-button .yt-spec-button-shape-next, 
    ytd-toggle-button-renderer:nth-of-type(1) button#button, 
    #like-button .yt-spec-button-shape-next, #like-button button#button {
      &::before {
        background-position: 0 0;
      }
      
      &[aria-pressed="true"]::before, .style-default-active::before {
        background-position: 0 calc(var(--size) * -1);
      }
    }
    
    /* Dislike Button */
    #segmented-dislike-button .yt-spec-button-shape-next {
      width: auto;
    }
    
    #segmented-dislike-button .yt-spec-button-shape-next, 
    ytd-toggle-button-renderer:nth-of-type(2) button#button, 
    #dislike-button .yt-spec-button-shape-next, #dislike-button button#button {
      &::before {
        background-position: calc(var(--size) * -1) 0;
      }
      
      &[aria-pressed="true"]::before, .style-default-active::before {
        background-position: calc(var(--size) * -1) calc(var(--size) * -1);
      }
    }
    
    /* Share Button */
    #top-level-buttons-computed .yt-spec-button-shape-next[aria-label="Share" i], 
    ytd-button-renderer button#button[aria-label="Share" i] {
      &::before {
        background-image: var(--other-icons);
        background-position: calc(var(--size) * -1) 0;
      }
    }
    
    
    /* Clip Button */
    #flexible-item-buttons .yt-spec-button-shape-next[aria-label="Clip" i], 
    ytd-button-renderer button#button[aria-label="Clip" i] {
      &::before {
        background-image: var(--other-icons);
        background-position: 0 0;
      }
    }
    
    /* Save Button */
    #flexible-item-buttons .yt-spec-button-shape-next[aria-label="Save to playlist" i], 
    ytd-button-renderer button#button[aria-label="Save to playlist" i] {
      &::before {
        background-image: var(--other-icons);
        background-position: 0 calc(var(--size) * -1);
      }
    }
  }

}